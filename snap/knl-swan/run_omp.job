#!/bin/bash
#PBS -q knl64
#PBS -l os=CLE_quad_flat
#PBS -l nodes=1
#PBS -l walltime=00:15:00
#PBS -joe

# ng=32, so need two MPI ranks to utilise all 64 cores
NY=8 \
NZ=8 \
NPEY=2 \
NPEZ=1 \
NANG=36 \
NTHREADS=32 \
ICHUNK=16 \
envsubst <$BENCHMARK_TEMPLATE >$CONFIG.in

export OMP_NUM_THREADS=32
aprun -n 2 -d 32 -j 1 -cc depth numactl -m 1 ./$BENCHMARK_EXE $CONFIG.in $CONFIG.out
